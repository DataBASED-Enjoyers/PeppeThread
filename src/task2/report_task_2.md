# Оценка числа π методом Монте-Карло с использованием многопоточности

Алгоритм для оценки значения числа π методом Монте-Карло был реализован с использованием многопоточности через библиотеку `pthreads`. 

Общее число испытаний (`ntrials`) равномерно распределяется между потоками, каждый из которых выполняет функцию `compute_pi`. В этой функции генерируются точки и подсчитывается количество попаданий в окружность. После завершения работы всех потоков результаты суммируются, объединяя количество попаданий.

## Измерение времени выполнения

Время выполнения программы измеряется с помощью функций замера времени до начала вычислений и после их окончания. 

Общее время выполнения зависит от двух факторов:
- **Число потоков (`nthreads`)**: увеличение количества потоков должно сокращать время выполнения до определённого предела.
- **Число испытаний (`ntrials`)**: большее количество испытаний повышает точность оценки числа π, но увеличивает время выполнения.

## Основные метрики параллельной реализации

Для оценки эффективности параллельной реализации используются следующие метрики:

- **Ускорение (S)**:

  $`
  S = \frac{T_{\text{послед}}}{T_{\text{паралл}}}
  `$

- **Эффективность (E)**:

  $`
  E = \frac{S}{nthreads}
  `$

## Результаты тестов

Тесты проводились с различным числом потоков при фиксированном количестве испытаний (`ntrials = 100000`).

| Количество потоков | Среднее время выполнения (`T_avg`), сек | Ускорение (`S`) | Эффективность (`E`) |
|--------------------|-----------------------------------------|-----------------|---------------------|
| 1 (последовательный алгоритм) | 0.001059 | -       | -       |
| 2  | 0.001281 | 0.8266 | 0.4133 |
| 8  | 0.000792 | 1.3362 | 0.1670 |
| 16 | 0.000806 | 1.3133 | 0.0820 |
| 64 | 0.001709 | 0.6193 | 0.0096 |

Файлы со статистической информацией по времени выполнения доступны в `.csv`-файле: `execution_times_n_threads.csv`.

---

## Анализ результатов

### Влияние числа потоков
С увеличением числа потоков наблюдается сокращение времени выполнения, но после достижения числа, равного количеству физических ядер процессора, дальнейшее увеличение потоков не даёт значительного выигрыша.

### Ускорение
Ускорение растёт с увеличением числа потоков, но не линейно, из-за накладных расходов на управление потоками и ограничений аппаратного обеспечения.

### Эффективность
Эффективность резко снижается при увеличении числа потоков, особенно при превышении числа физических ядер. Это связано с накладными расходами на контекстные переключения и конкуренцией за ресурсы.

### Объём данных
При большом числе испытаний параллельная программа демонстрирует лучшую масштабируемость и эффективность.

---

## Выводы

1. **Преимущества параллельности**: Многопоточность позволяет значительно сократить время выполнения задачи вычисления числа π методом Монте-Карло.
2. **Оптимальное число потоков**: Наиболее эффективным является использование количества потоков, равного числу физических ядер процессора.
3. **Накладные расходы**: При параллелизации необходимо учитывать накладные расходы на создание и управление потоками, что может снизить эффективность при большом количестве потоков.
4. **Рекомендации**: Для максимальной производительности рекомендуется балансировать количество потоков и объём вычислений с учётом особенностей конкретного аппаратного обеспечения.
